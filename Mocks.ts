/* eslint-disable @typescript-eslint/no-empty-function */
/* eslint-disable @typescript-eslint/no-explicit-any */
/* eslint-disable @typescript-eslint/explicit-module-boundary-types */
export const Mocks = {
  createMockConfig: () => ({
    GEMINI_API_KEY: 'test-api-key',
    gemini_model: 'gemini-2.5-flash',
    unprocessed_label: 'unprocessed',
    processed_label: 'processed',
    processing_failed_label: 'error',
    processing_frequency_in_minutes: 5,
    hour_of_day_to_run_sanity_checking: 0,
    go_link: '',
    max_threads: 50,
    default_task_list_name: 'My Tasks',
    task_service: 'Google Tasks',
    todoist_api_key: '',
    todoist_project_id: '',
  }),
  createMockGmailThread: (subject: string): GoogleAppsScript.Gmail.GmailThread => ({
    getFirstMessageSubject: () => subject,
    getId: () => 'thread-id',
    getMessages: () => [Mocks.getMockMessage({})],
    moveToInbox: jest.fn(),
    addLabel: jest.fn(),
    removeLabel: jest.fn(),
    markRead: jest.fn(),
    markUnread: jest.fn(),
    createDraftReply: jest.fn(),
    createDraftReplyAll: jest.fn(),
    getLabels: jest.fn(),
    getLastMessageDate: jest.fn(),
    getMessageCount: jest.fn(),
    getPermalink: jest.fn(),
    hasStarredMessages: jest.fn(),
    isImportant: jest.fn(),
    isInChats: jest.fn(),
    isInInbox: jest.fn(),
    isInSpam: jest.fn(),
    isInTrash: jest.fn(),
    isUnread: jest.fn(),
    moveToSpam: jest.fn(),
    refresh: jest.fn(),
    reply: jest.fn(),
    replyAll: jest.fn(),
  } as any),

  getMockThread: (overrides: Partial<GoogleAppsScript.Gmail.GmailThread>): GoogleAppsScript.Gmail.GmailThread => ({
    ...{
      getId: () => 'thread-id',
      getFirstMessageSubject: () => 'Test Subject',
      getMessages: () => [],
      removeLabel: () => {},
      addLabel: () => {},
      moveToArchive: () => {},
      moveToInbox: () => {},
      moveToTrash: () => {},
      markRead: () => {},
      markUnread: () => {},
      createDraftReply: () => ({} as any),
      createDraftReplyAll: () => ({} as any),
      getLabels: () => [],
      getLastMessageDate: () => new Date(),
      getMessageCount: () => 1,
      getPermalink: () => '',
      hasStarredMessages: () => false,
      isImportant: () => false,
      isInChats: () => false,
      isInInbox: () => false,
      isInSpam: () => false,
      isInTrash: () => false,
      isUnread: () => false,
      moveToSpam: () => {},
      refresh: () => {},
      reply: () => ({} as any),
      replyAll: () => ({} as any),
    },
    ...overrides,
  }),
  getMockMessage: (overrides: Partial<GoogleAppsScript.Gmail.GmailMessage>): GoogleAppsScript.Gmail.GmailMessage => ({
    ...{
      getDate: () => new Date(),
      getFrom: () => 'test@example.com',
      getTo: () => 'test@example.com',
      getSubject: () => 'Test Subject',
      getPlainBody: () => 'Test Body',
    },
    ...overrides,
  } as any),
  getMockSheet: (data: any[][]): GoogleAppsScript.Spreadsheet.Sheet => ({
    getDataRange: () => ({
      getValues: () => data,
      getDisplayValues: () => data,
    } as any),
  } as any),
  getMockSpreadsheet: (sheets: { [key: string]: GoogleAppsScript.Spreadsheet.Sheet }): GoogleAppsScript.Spreadsheet.Spreadsheet => ({
    getSheetByName: (name: string) => sheets[name],
    addDeveloperMetadata: () => ({} as any),
    addEditor: () => ({} as any),
    addEditors: () => ({} as any),
    addMenu: () => {},
    addViewer: () => ({} as any),
    addViewers: () => ({} as any),
    appendRow: () => ({} as any),
    copy: () => ({} as any),
    createDeveloperMetadataFinder: () => ({} as any),
    deleteActiveSheet: () => ({} as any),
    deleteColumn: () => ({} as any),
    deleteColumns: () => {},
    deleteRow: () => ({} as any),
    deleteRows: () => {},
    deleteSheet: () => {},
    duplicateActiveSheet: () => ({} as any),
    getActiveCell: () => ({} as any),
    getActiveRange: () => ({} as any),
    getActiveSheet: () => ({} as any),
    getBandings: () => [],
    getBlob: () => ({} as any),
    getColumnWidth: () => 0,
    getConditionalFormatRules: () => [],
    getDataRange: () => ({} as any),
    getDeveloperMetadata: () => [],
    getEditors: () => [],
    getFormUrl: () => '',
    getFrozenColumns: () => 0,
    getFrozenRows: () => 0,
    getId: () => '',
    getImages: () => [],
    getLastColumn: () => 0,
    getLastRow: () => 0,
    getName: () => '',
    getNumSheets: () => 0,
    getOwner: () => ({} as any),
    getPredefinedSpreadsheetThemes: () => [],
    getProtections: () => [],
    getRange: () => ({} as any),
    getRangeByName: () => ({} as any),
    getRowHeight: () => 0,
    getSheets: () => [],
    getSpreadsheetTheme: () => ({} as any),
    getSpreadsheetUrl: () => '',
    getTimeZone: () => '',
    getToken: () => '',
    getUrl: () => '',
    getViewers: () => [],
    hideSheet: () => {},
    insertColumnAfter: () => ({} as any),
    insertColumnBefore: () => ({} as any),
    insertColumnsAfter: () => {},
    insertColumnsBefore: () => {},
    insertImage: () => ({} as any),
    insertRowAfter: () => ({} as any),
    insertRowBefore: () => ({} as any),
    insertRowsAfter: () => {},
    insertRowsBefore: () => {},
    insertSheet: () => ({} as any),
    moveActiveSheet: () => {},
    moveChartToObjectSheet: () => ({} as any),
    removeEditor: () => ({} as any),
    removeMenu: () => {},
    removeNamedRange: () => {},
    removeViewer: () => ({} as any),
    rename: () => {},
    renameActiveSheet: () => {},
    resetSpreadsheetTheme: () => ({} as any),
    setActiveRange: () => ({} as any),
    setActiveSheet: () => ({} as any),
    setActiveSpreadsheet: () => {},
    setColumnWidth: () => ({} as any),
    setConditionalFormatRules: () => {},
    setFrozenColumns: () => {},
    setFrozenRows: () => {},
    setNamedRange: () => {},
    setRowHeight: () => ({} as any),
    setSpreadsheetTheme: () => ({} as any),
    setTimeZone: () => {},
    show: () => {},
    sort: () => ({} as any),
    toast: () => {},
    unhide: () => {},
    updateMenu: () => {},
    autoResizeColumn: () => ({} as any),
    createTextFinder: () => ({} as any),
    getActiveRangeList: () => ({} as any),
    getAs: () => ({} as any),
    getNamedRanges: () => [],
    getRangeList: () => ({} as any),
    getSheetId: () => 0,
    getSheetValues: () => [[]],
    getSlicer: () => ({} as any),
    getSlicers: () => [],
    getSupportedThemes: () => [],
    hideColumn: () => {},
    hideRow: () => {},
    insertChart: () => ({} as any),
    insertColumns: () => {},
    insertFilter: () => ({} as any),
    insertImageWithDescription: () => ({} as any),
    insertImageWithUrl: () => ({} as any),
    insertPivotTable: () => ({} as any),
    insertSlicer: () => ({} as any),
    isColumnHiddenByUser: () => false,
    isRowHiddenByFilter: () => false,
    isRowHiddenByUser: () => false,
    moveColumns: () => {},
    moveRows: () => {},
    protect: () => ({} as any),
    removeFilter: () => {},
    removeSlicer: () => {},
    setColumnWidths: () => {},
    setRowHeights: () => {},
    showColumn: () => {},
    showRow: () => {},
    unhideColumn: () => {},
    unhideRow: () => {},
    getCurrentCell: () => ({} as any),
    getDataSourceTables: () => [],
    getIterativeCalculationConvergenceThreshold: () => 0,
    getMaxIterativeCalculationCycles: () => 0,
    getRecalculationInterval: () => ('' as any),
    getSpreadsheetLocale: () => '',
    isIterativeCalculationEnabled: () => false,
    moveChartToObject: () => ({} as any),
    setIterativeCalculationConvergenceThreshold: () => ({} as any),
    setMaxIterativeCalculationCycles: () => ({} as any),
    setRecalculationInterval: () => ({} as any),
    setSpreadsheetLocale: () => {},
  }),
  createMockUrlFetchApp: () => ({
    fetch: jest.fn(() => Mocks.getMockUrlFetchResponse(200, '[]')),
    fetchAll: jest.fn(),
    getRequest: jest.fn(),
  }),

  getMockUrlFetchResponse: (code: number, content: string) => ({
    getResponseCode: () => code,
    getContentText: () => content,
    getAllHeaders: () => ({}),
    getAs: () => ({} as any),
    getBlob: () => ({} as any),
    getContent: () => [],
    getHeaders: () => ({}),
  }),
  getMockTask: (overrides: Partial<GoogleAppsScript.Tasks.Schema.Task>): GoogleAppsScript.Tasks.Schema.Task => ({
    ...{
      id: 'task-id',
      title: 'Test Task',
      notes: 'gmail_thread_id: thread-id',
      completed: null,
      due: null,
      hidden: false,
      parent: null,
      position: '0',
      status: 'needsAction',
      links: [],
      selfLink: '',
      updated: '',
    },
    ...overrides,
  } as any),
  createMockTasks: (): any => ({
    Tasklists: {
      list: jest.fn(() => ({ items: [Mocks.getMockTaskList({ title: 'My Tasks' })] })),
      insert: jest.fn(() => Mocks.getMockTaskList({})),
    },
    Tasks: {
      list: jest.fn(() => ({ items: [] })),
      insert: jest.fn(),
      update: jest.fn(() => Mocks.getMockTask({})),
    },
  }),

  getMockTaskList: (overrides: any) => ({
    ...{
      id: 'task-list-id',
      title: 'Test Task List',
      selfLink: '',
      updated: '',
    },
    ...overrides,
  }),
};